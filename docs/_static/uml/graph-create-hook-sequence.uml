    @startuml
    hide footbox
    skinparam shadowing false

    actor Client
    participant "Webhook\nService" as Webhook
    participant GitLab
    participant "Tokens\nRepository" as Tokens
    database "Event\nLog" as Log

    == Webhook creation - hook does exists ==
    Client->Webhook: POST /projects/:id/webhooks
    activate Webhook
    ref over Webhook, Log: Hook Validation as presented above returning hook exists
    Webhook->Client: OK
    deactivate Webhook

    == Webhook creation - hook does not exist ==
    Client->Webhook: POST /projects/:id/webhooks
    activate Webhook
    ref over Webhook, Log: Hook Validation as presented above returning hook does not exist
    Webhook->GitLab: GET /api/v4/projects/:id
    activate GitLab
    GitLab->Webhook: OK with project info
    deactivate GitLab
    Webhook->GitLab: POST /api/v4/projects/:id/hooks
    activate GitLab
    GitLab->Webhook: OK
    deactivate GitLab
    Webhook->Tokens: PUT /projects/:id/tokens
    activate Tokens
    Tokens->Webhook: NO_CONTENT
    deactivate Tokens
    group Events history loading
    Webhook->GitLab: GET /api/v4/projects/:id/events?action=pushed
    activate GitLab
    GitLab->Webhook: OK with the latest Push Event
    deactivate GitLab
    ref over Webhook, Log: Push Event to Event Log Events
    end
    Webhook->Client: CREATED
    deactivate Webhook

    @enduml
